module.exports=[75641,a=>{"use strict";function b(a,b){let c=window.atob(a),d=new Uint8Array(c.length);for(let a=0;a<c.length;a++)d[a]=c.charCodeAt(a);return new Blob([d],{type:b})}let c=[50,150,250,350,450,570,700,840,1e3,1170,1370,1600,1850,2150,2500,2900,3400,4e3,4800,5800,7e3,8500,10500,13500];function d(){return Array.from({length:24}).map(()=>0)}var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},G=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},H=function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};class I extends EventTarget{get playing(){return G(this,o,"f")}get muted(){return G(this,p,"f")}get volume(){return G(this,q,"f")}get fft(){return G(this,s,"f")}constructor(a={}){var b,g,A;if(super(),e.add(this),this.opts=a,j.set(this,null),k.set(this,null),l.set(this,null),m.set(this,null),n.set(this,!1),o.set(this,!1),p.set(this,!1),q.set(this,void 0),r.set(this,void 0),s.set(this,d()),t.set(this,null),u.set(this,null),v.set(this,[]),w.set(this,null),x.set(this,!1),y.set(this,null),z.set(this,{}),H(this,q,null!=(b=a.volume)?b:1,"f"),H(this,r,null!=(g=a.disableAudioWorklet)&&g,"f"),null==(A=a.fft)?void 0:A.enabled){const{size:b,interval:d,transform:e}=a.fft;H(this,u,{size:null!=b?b:G(f,f,"f",h),interval:null!=d?d:G(f,f,"f",i),transform:null!=e?e:(a,b)=>{let d;return d=b/2/a.length,c.map(b=>{var c;let e=Math.round(b/d);return e>=0&&e<a.length?((null!=(c=a[e])?c:0)-0)/255*2:0})}},"f")}}on(a,b,c){return super.addEventListener(a,b,c),this}init(){return F(this,void 0,void 0,function*(){if(!G(this,n,"f")){H(this,j,new AudioContext,"f"),G(this,j,"f").audioWorklet||(console.warn("AudioWorklet is not supported in this browser. Falling back to Regular Buffer Mode."),H(this,r,!0,"f"));try{if(H(this,m,G(this,j,"f").createGain(),"f"),G(this,m,"f").gain.value=G(this,q,"f"),G(this,u,"f")?(H(this,l,G(this,j,"f").createAnalyser(),"f"),G(this,l,"f").fftSize=G(this,u,"f").size):(H(this,l,G(this,j,"f").createAnalyser(),"f"),G(this,l,"f").fftSize=G(f,f,"f",h)),G(this,r,"f")){let a=G(this,l,"f"),b=G(this,m,"f"),c=G(this,j,"f").destination;[a,b,c].filter(Boolean).reduce((a,b)=>(a.connect(b),b))}else{yield G(this,j,"f").audioWorklet.addModule(G(f,f,"f",g)),H(this,k,new AudioWorkletNode(G(this,j,"f"),"audio-processor"),"f"),G(this,k,"f").port.onmessage=a=>{"ended"===a.data.type&&(H(this,o,!1,"f"),this.dispatchEvent(new CustomEvent("stop",{detail:{id:"stream"}})))};let a=G(this,k,"f"),b=G(this,l,"f"),c=G(this,m,"f"),d=G(this,j,"f").destination;[a,b,c,d].filter(Boolean).reduce((a,b)=>(a.connect(b),b))}G(this,e,"m",A).call(this),yield G(this,j,"f").resume(),H(this,n,!0,"f")}catch(b){let a=b instanceof Error?`: ${b.message}`:String(b);throw G(this,e,"m",B).call(this,`Failed to initialize audio player${a}`),b}}})}enqueue(a){return F(this,void 0,void 0,function*(){if(!G(this,n,"f")||!G(this,j,"f"))return void G(this,e,"m",B).call(this,"Audio player is not initialized");if(G(this,r,"f"))try{let b=yield G(this,e,"m",C).call(this,a);if(!b)return void G(this,e,"m",B).call(this,"Failed to convert data to audio buffer");let c=G(this,e,"m",D).call(this,a,b);if(0===c.length)return;for(let a of c)G(this,v,"f").push({id:a.id,buffer:a.buffer,index:a.index}),1===G(this,v,"f").length&&G(this,e,"m",E).call(this)}catch(b){let a=b instanceof Error?b.message:"Unknown error";G(this,e,"m",B).call(this,`Failed to add clip to queue: ${a}`)}else try{let{data:c,id:d}=a,e=b(c),f=yield e.arrayBuffer(),g=(yield G(this,j,"f").decodeAudioData(f)).getChannelData(0);G(this,k,"f").port.postMessage({type:"audio",data:g}),H(this,o,!0,"f"),this.dispatchEvent(new CustomEvent("play",{detail:{id:d}}))}catch(b){let a=b instanceof Error?b.message:"Unknown error";G(this,e,"m",B).call(this,`Failed to queue clip: ${a}`)}})}stop(){var a;G(this,r,"f")?(G(this,w,"f")&&(G(this,w,"f").stop(),G(this,w,"f").disconnect(),H(this,w,null,"f")),H(this,v,[],"f"),H(this,x,!1,"f")):null==(a=G(this,k,"f"))||a.port.postMessage({type:"fadeAndClear"}),G(this,e,"m",A).call(this),H(this,o,!1,"f"),this.dispatchEvent(new CustomEvent("stop",{detail:{id:"manual"}}))}setVolume(a){let b=Math.max(0,Math.min(a,1));H(this,q,b,"f"),G(this,m,"f")&&G(this,j,"f")&&!G(this,p,"f")&&G(this,m,"f").gain.setValueAtTime(b,G(this,j,"f").currentTime)}mute(){G(this,m,"f")&&G(this,j,"f")&&(G(this,m,"f").gain.setValueAtTime(0,G(this,j,"f").currentTime),H(this,p,!0,"f"))}unmute(){G(this,m,"f")&&G(this,j,"f")&&(G(this,m,"f").gain.setValueAtTime(G(this,q,"f"),G(this,j,"f").currentTime),H(this,p,!1,"f"))}dispose(){var a,b,c,e,f,g,h;null!=G(this,t,"f")&&(clearInterval(G(this,t,"f")),H(this,t,null,"f")),G(this,r,"f")?(G(this,w,"f")&&(G(this,w,"f").stop(),G(this,w,"f").disconnect(),H(this,w,null,"f")),H(this,v,[],"f"),H(this,x,!1,"f")):(null==(a=G(this,k,"f"))||a.port.postMessage({type:"fadeAndClear"}),null==(b=G(this,k,"f"))||b.port.postMessage({type:"end"}),null==(c=G(this,k,"f"))||c.port.close(),null==(e=G(this,k,"f"))||e.disconnect()),null==(f=G(this,l,"f"))||f.disconnect(),null==(g=G(this,m,"f"))||g.disconnect(),null==(h=G(this,j,"f"))||h.close().catch(()=>void 0),H(this,n,!1,"f"),H(this,o,!1,"f"),H(this,s,d(),"f")}}f=I,j=new WeakMap,k=new WeakMap,l=new WeakMap,m=new WeakMap,n=new WeakMap,o=new WeakMap,p=new WeakMap,q=new WeakMap,r=new WeakMap,s=new WeakMap,t=new WeakMap,u=new WeakMap,v=new WeakMap,w=new WeakMap,x=new WeakMap,y=new WeakMap,z=new WeakMap,e=new WeakSet,A=function(){if(!G(this,u,"f")||!G(this,l,"f"))return;G(this,t,"f")&&clearInterval(G(this,t,"f"));let{interval:a,transform:b}=G(this,u,"f");H(this,t,window.setInterval(()=>{let a=new Uint8Array(G(this,l,"f").frequencyBinCount);G(this,l,"f").getByteFrequencyData(a),H(this,s,b(a,G(this,j,"f").sampleRate),"f"),this.dispatchEvent(new CustomEvent("fft",{detail:{fft:G(this,s,"f")}}))},a),"f")},B=function(a){this.dispatchEvent(new CustomEvent("error",{detail:{message:a}}))},C=function(a){return F(this,void 0,void 0,function*(){if(!G(this,n,"f")||!G(this,j,"f"))return void G(this,e,"m",B).call(this,"Audio player has not been initialized");let c=b(a.data),d=yield c.arrayBuffer();return yield G(this,j,"f").decodeAudioData(d)})},D=function(a,b){var c,d;if("__proto__"===a.id||"constructor"===a.id||"prototype"===a.id)return G(this,e,"m",B).call(this,`Attempted to use a dangerous property name as message ID: ${a.id}`),[];if(G(this,z,"f")[a.id]||(G(this,z,"f")[a.id]=[]),!Number.isInteger(a.index)||a.index<0)return G(this,e,"m",B).call(this,`Attempted to use an invalid index: ${a.index}`),[];let f=G(this,z,"f")[a.id]||[];f[a.index]=b;let g=null==(c=G(this,y,"f"))?void 0:c.id,h=[];if(a.id!==g)if(!f[0])return[];else H(this,y,{id:a.id,index:0},"f"),h.push({id:a.id,index:0,buffer:f[0]}),f[0]=void 0;let i=((null==(d=G(this,y,"f"))?void 0:d.index)||0)+1,j=f[i];for(;j;)h.push({index:i,buffer:j,id:a.id}),f[i]=void 0,H(this,y,{id:a.id,index:i},"f"),i+=1,j=f[i];return h},E=function a(){var b,c;if(0===G(this,v,"f").length||G(this,x,"f"))return;if(null===G(this,l,"f")||null===G(this,j,"f"))return void G(this,e,"m",B).call(this,"Audio player is not initialized");let f=G(this,v,"f").shift();if(!f)return;H(this,x,!0,"f"),H(this,o,!0,"f");let g=G(this,j,"f").createBufferSource();g.buffer=f.buffer,G(this,l,"f")&&g.connect(G(this,l,"f")),G(this,m,"f")?(null==(b=G(this,l,"f"))||b.connect(G(this,m,"f")),G(this,m,"f").connect(G(this,j,"f").destination)):null==(c=G(this,l,"f"))||c.connect(G(this,j,"f").destination),H(this,w,g,"f"),G(this,e,"m",A).call(this),g.start(0),0===f.index&&this.dispatchEvent(new CustomEvent("play",{detail:{id:f.id}})),g.onended=()=>{G(this,t,"f")&&(clearInterval(G(this,t,"f")),H(this,t,null,"f")),H(this,s,d(),"f"),g.disconnect(),H(this,x,!1,"f"),H(this,o,!1,"f"),this.dispatchEvent(new CustomEvent("stop",{detail:{id:f.id}})),H(this,w,null,"f"),G(this,e,"m",a).call(this)}},g={value:"https://storage.googleapis.com/evi-react-sdk-assets/audio-worklet-20250506.js"},h={value:2048},i={value:16},a.s(["EVIWebAudioPlayer",()=>I],75641)}];

//# sourceMappingURL=dist_esm_wrapper_EVIWebAudioPlayer_mjs_a049e242._.js.map